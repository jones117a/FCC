
# Make new analysis directory
mkdir FCC
cd FCC

# Import latest version of heppy
git clone https://github.com/HEP-FCC/heppy/

# Set up software
# We need to setup both heppy and the FCC software environment
# --- EVERY TIME YOU LOG IN ---
source ./init.sh
cd ..
source /afs/cern.ch/exp/fcc/sw/0.8pre/setup.sh

# Make a working directory
mkdir WorkDir
cd WorkDir

# Copy the config file for signal event generation
wget https://raw.githubusercontent.com/HEP-FCC/fcc-physics/master/pythia8/ee_ZH_Z_Hbb.txt

# Inspect the file ee_ZH_Z_Hbb
# What centre-of-mass energy do we use?
# What decay modes do we select for Z and H?

# Let's generate some events!
python generate.py

# Inspect the .root output file
# Try to understand its contents.

# Copy the actual analysis code
cp ../heppy/test/analysis_ee_ZH_had_cfg.py .

# Run the analysis code on the first 1000 events
heppy OutDir analysis_ee_ZH_cfg.py -N 1000

# Inspect the output file
# Try to understand its contents.

# Now we need to switch to Higgs decays to two photons
# Create new file ee_ZH_Z_Hgamgam.txt in which the Higgs is forced to decay to photons.

# Generate events as before!

# How do you need to modify the analysis code to select this new signal process?

# PARALLEL PROCESSING

# Generate events:
mkdir BatchDir
cd !$
cp /afs/cern.ch/user/k/kbehr/public/FCCAnalysis/batch_launch_gen.sh .
cp /afs/cern.ch/user/k/kbehr/public/FCCAnalysis/generate.py .
cp /afs/cern.ch/user/k/kbehr/public/FCCAnalysis/ee_ZH_Z_Hgamgam.txt .

# Note that ee_ZH_Z_Hgamgam.txt has been updated in two places:
# 1) added random seeds, 2) added beam energy smearing

# Update batch_launch_gen.sh to point to your BatchDir and AFS directories

# Launch the generation
python generate.py

# You can check the job status via
bjobs

# Inspect the output files
# Make sure they have slightly different size.
# If the sizes are exactly the same, they had the same random seed.
